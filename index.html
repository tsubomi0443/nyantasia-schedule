<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8" />
    <title>にゃんたじあ スケジュールツール</title>
    <!-- © Nyantagia Schedule Tool — Redistribution Prohibited -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet" />
    <script src="https://unpkg.com/react@18/umd/react.development.js"></script>
    <script src="https://unpkg.com/react-dom@18/umd/react-dom.development.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <style>
        body{background:#fafafa;}
        .event-card{border-left:5px solid #0d6efd;padding:8px 10px;background:#fff;margin-bottom:4px;}
        .timetable-wrapper{overflow-x:auto;background:#fff;border-radius:.5rem;padding:.75rem;border:1px solid #dee2e6;}
        .timetable table{font-size:.8rem;white-space:nowrap;}
        .timetable th,.timetable td{vertical-align:top;min-width:120px;}
        .time-col{width:60px;position:sticky;left:0;background:#f8f9fa;z-index:2;}
        .date-header{text-align:center;font-weight:bold;}
        .event-chip{display:block;font-size:.7rem;padding:2px 4px;border-radius:4px;margin-bottom:2px;color:#fff;}
        .member-legend-badge{display:inline-block;padding:2px 8px;border-radius:999px;font-size:.75rem;margin:2px 4px 2px 0;color:#fff;}
        .member-color-0{background:#ff8a80;}
        .member-color-1{background:#ffb74d;}
        .member-color-2{background:#ffd54f;color:#000;}
        .member-color-3{background:#81c784;}
        .member-color-4{background:#4fc3f7;}
        .member-color-5{background:#9575cd;}
        .member-color-6{background:#f06292;}
        .member-color-7{background:#a1887f;}
        .mobile-day-card{background:#fff;border-radius:.5rem;padding:.75rem;border:1px solid #dee2e6;margin-bottom:.75rem;}
        .mobile-event-row{display:flex;justify-content:space-between;align-items:flex-start;margin-bottom:4px;}
        .mobile-event-time{font-size:.8rem;width:60px;flex-shrink:0;color:#555;}
        .mobile-event-content{flex:1;font-size:.8rem;margin-left:4px;}
        @media(max-width:767.98px){body{padding:12px;}}
    </style>
</head>
<body class="container py-4">
<h2 class="mb-1 fw-bold">にゃんたじあ スケジュールツール</h2>
<div id="app"></div>

<script type="text/babel">
    /* --- 難読化レベル中〜強：可読性を下げたJS --- */
    (()=>{
        const A=React,B=A.useState,C=A.useMemo;
        const D=`Subject,Start Date,Start Time,End Date,End Time,Description,All Day Event
[若魔麦たると] 朝活,2025/12/08,06:00,2025/12/08,07:00,にゃんたじあ！スケジュール,False
[ニャマシュバ・ルッツ] 朝活,2025/12/08,07:00,2025/12/08,08:00,にゃんたじあ！スケジュール,False
[若魔陽エル] ゲーム,2025/12/08,12:00,2025/12/08,13:00,にゃんたじあ！スケジュール,False
[若魔影ネオン] ゲーム,2025/12/08,19:00,2025/12/08,20:00,にゃんたじあ！スケジュール,False
[若魔陽エル] ゲーム,2025/12/08,19:00,2025/12/08,20:00,にゃんたじあ！スケジュール,False
[若魔雲ふわり] ゲーム,2025/12/08,20:00,2025/12/08,21:00,にゃんたじあ！スケジュール,False
[若魔藤あんず] コラボ,2025/12/08,21:00,2025/12/08,22:00,にゃんたじあ！スケジュール,False
[ニャマルベール・ペルル] ゲーム,2025/12/08,21:00,2025/12/08,22:00,にゃんたじあ！スケジュール,False
[若魔雲ふわり] ASMR,2025/12/09,00:00,2025/12/09,01:00,にゃんたじあ！スケジュール(24:00表記),False
[若魔白ソーダ] ゲーム,2025/12/08,,,2025/12/08,,にゃんたじあ！スケジュール(時間指定なし),True
[ニャマシュバ・ルッツ] ゲーム,2025/12/09,18:00,2025/12/09,19:00,にゃんたじあ！スケジュール,False
[若魔影ネオン] ゲーム,2025/12/09,19:00,2025/12/09,20:00,にゃんたじあ！スケジュール,False
[若魔陽エル] ゲーム,2025/12/09,19:00,2025/12/09,20:00,にゃんたじあ！スケジュール,False
[若魔藤あんず] 告知,2025/12/09,20:00,2025/12/09,21:00,にゃんたじあ！スケジュール,False
[若魔白ソーダ] コラボ,2025/12/09,20:00,2025/12/09,21:00,にゃんたじあ！スケジュール,False
[若魔雲ふわり] コラボ,2025/12/09,21:00,2025/12/09,22:00,にゃんたじあ！スケジュール,False
[若魔雲ふわり] ASMR,2025/12/10,00:00,2025/12/10,01:00,にゃんたじあ！スケジュール(24:00表記),False
[若魔麦たると] 朝活,2025/12/10,07:00,2025/12/10,08:00,にゃんたじあ！スケジュール,False
[若魔陽エル] ゲーム,2025/12/10,12:00,2025/12/10,13:00,にゃんたじあ！スケジュール,False
[ニャマシュバ・ルッツ] ゲーム,2025/12/10,18:00,2025/12/10,19:00,にゃんたじあ！スケジュール,False
[若魔影ネオン] ゲーム,2025/12/10,19:00,2025/12/10,20:00,にゃんたじあ！スケジュール,False
[若魔雲ふわり] ゲーム,2025/12/10,19:00,2025/12/10,20:00,にゃんたじあ！スケジュール,False
[若魔陽エル] ゲーム,2025/12/10,20:00,2025/12/10,21:00,にゃんたじあ！スケジュール,False
[ニャマルベール・ペルル] 雑談,2025/12/10,21:00,2025/12/10,22:00,にゃんたじあ！スケジュール,False
[若魔雲ふわり] ASMR,2025/12/11,00:00,2025/12/11,01:00,にゃんたじあ！スケジュール(24:00表記),False
[若魔白ソーダ] ゲーム,2025/12/10,,,2025/12/10,,にゃんたじあ！スケジュール(時間指定なし),True
[若魔陽エル] ゲーム,2025/12/11,12:00,2025/12/11,13:00,にゃんたじあ！スケジュール,False
[ニャマシュバ・ルッツ] ゲーム,2025/12/11,18:00,2025/12/11,19:00,にゃんたじあ！スケジュール,False
[若魔白ソーダ] コラボ,2025/12/11,19:00,2025/12/11,20:00,にゃんたじあ！スケジュール,False
[若魔影ネオン] ゲーム,2025/12/11,19:00,2025/12/11,20:00,にゃんたじあ！スケジュール,False
[若魔麦たると] コラボ,2025/12/11,20:00,2025/12/11,21:00,にゃんたじあ！スケジュール,False
[若魔藤あんず] VRCコラボ,2025/12/11,22:00,2025/12/11,23:00,にゃんたじあ！スケジュール,False
[若魔麦たると] VRCコラボ,2025/12/11,22:00,2025/12/11,23:00,にゃんたじあ！スケジュール,False
[若魔雲ふわり] VRCコラボ,2025/12/11,22:00,2025/12/11,23:00,にゃんたじあ！スケジュール,False
[若魔陽エル] VRCコラボ,2025/12/11,22:00,2025/12/11,23:00,にゃんたじあ！スケジュール,False
[若魔陽エル] ゲーム,2025/12/12,12:00,2025/12/12,13:00,にゃんたじあ！スケジュール,False
[ニャマシュバ・ルッツ] ゲーム,2025/12/12,18:00,2025/12/12,19:00,にゃんたじあ！スケジュール,False
[若魔影ネオン] ゲーム,2025/12/12,19:00,2025/12/12,20:00,にゃんたじあ！スケジュール,False
[若魔雲ふわり] コラボ,2025/12/12,20:00,2025/12/12,21:00,にゃんたじあ！スケジュール,False
[ニャマルベール・ペルル] ゲーム,2025/12/12,20:00,2025/12/12,21:00,にゃんたじあ！スケジュール,False
[若魔藤あんず] コラボ,2025/12/12,21:00,2025/12/12,22:00,にゃんたじあ！スケジュール,False
[若魔麦たると] VRC,2025/12/12,21:00,2025/12/12,22:00,にゃんたじあ！スケジュール,False
[若魔陽エル] メン限,2025/12/12,23:00,2025/12/13,00:00,にゃんたじあ！スケジュール,False
[若魔雲ふわり] ASMR,2025/12/13,00:00,2025/12/13,01:00,にゃんたじあ！スケジュール(24:00表記),False
[若魔陽エル] ゲーム,2025/12/13,12:00,2025/12/13,13:00,にゃんたじあ！スケジュール,False
[ニャマルベール・ペルル] 企画,2025/12/13,12:00,2025/12/13,13:00,にゃんたじあ！スケジュール,False
[若魔麦たると] ゲーム,2025/12/13,15:00,2025/12/13,16:00,にゃんたじあ！スケジュール,False
[ニャマシュバ・ルッツ] 動画投稿,2025/12/13,18:00,2025/12/13,19:00,にゃんたじあ！スケジュール,False
[若魔影ネオン] ゲーム,2025/12/13,19:00,2025/12/13,20:00,にゃんたじあ！スケジュール,False
[若魔陽エル] ゲーム,2025/12/13,20:00,2025/12/13,21:00,にゃんたじあ！スケジュール,False
[若魔藤あんず] コラボ,2025/12/13,21:00,2025/12/13,22:00,にゃんたじあ！スケジュール,False
[若魔麦たると] イベント,2025/12/13,21:00,2025/12/13,22:00,にゃんたじあ！スケジュール,False
[ニャマルベール・ペルル] イベント,2025/12/13,21:00,2025/12/13,22:00,にゃんたじあ！スケジュール,False
[若魔雲ふわり] 歌枠,2025/12/13,22:00,2025/12/13,23:00,にゃんたじあ！スケジュール,False
[若魔雲ふわり] ASMR,2025/12/14,00:00,2025/12/14,01:00,にゃんたじあ！スケジュール(24:00表記),False
[若魔白ソーダ] ゲーム,2025/12/13,,,2025/12/13,,にゃんたじあ！スケジュール(時間指定なし),True
[若魔雲ふわり] 朝活,2025/12/14,06:30,2025/12/14,07:30,にゃんたじあ！スケジュール,False
[若魔陽エル] ゲーム,2025/12/14,12:00,2025/12/14,13:00,にゃんたじあ！スケジュール,False
[若魔麦たると] 雑談,2025/12/14,15:00,2025/12/14,16:00,にゃんたじあ！スケジュール,False
[若魔陽エル] ゲーム,2025/12/14,18:00,2025/12/14,19:00,にゃんたじあ！スケジュール,False
[ニャマシュバ・ルッツ] ゲーム,2025/12/14,18:00,2025/12/14,19:00,にゃんたじあ！スケジュール,False
[若魔藤あんず] 企画,2025/12/14,19:00,2025/12/14,20:00,にゃんたじあ！スケジュール,False
[若魔影ネオン] ゲーム,2025/12/14,19:00,2025/12/14,20:00,にゃんたじあ！スケジュール,False
[ニャマルベール・ペルル] コラボ,2025/12/14,20:00,2025/12/14,21:00,にゃんたじあ！スケジュール,False
[若魔麦たると] VRC,2025/12/14,21:00,2025/12/14,22:00,にゃんたじあ！スケジュール,False
[若魔白ソーダ] ゲーム,2025/12/14,,,2025/12/14,,にゃんたじあ！スケジュール(時間指定なし),True`;
        function E(t){const u=t.trim().split(/\r?\n/),v=[];for(let w=1;w<u.length;w++){const x=u[w].trim();if(!x)continue;const y=x.split(","),z=y.length;if(z<7)continue;const a0=y[0].trim(),a1=y[1].trim(),a2=(y[2]||"").trim(),a3=(y[3]||"").trim(),a4=(y[4]||"").trim(),a5=(y[z-1]||"").trim(),a6=y.slice(5,z-1).join(",").trim(),a7=a3||a1,a8=a4;const a9=a0.match(/^\[(.*?)\]/),aa=a9?a9[1]:"不明",ab=a0.replace(/^\[.*?\]\s*/,"");v.push({member:aa,title:ab,startDate:a1,startTime:a2,endDate:a7,endTime:a8,description:a6,allDay:a5==="True"})}const w=[...new Set(v.map(a=>a.member))];return{events:v,members:w}}
        const F=E(D);
        function G(){
            const[a,F0]=B(F.events),[b,F1]=B(F.members),[c,F2]=B("all");
            const H=(d,e)=>{if(!e)return d.replace(/\//g,"")+"T000000";let[f,g]=e.split(":").map(Number);f===24&&(f=0);const h=String(f).padStart(2,"0"),i=String(g).padStart(2,"0");return d.replace(/\//g,"")+"T"+h+i+"00"};
            const I=()=>{let d=a;if(c!=="all")d=d.filter(h=>h.member===c);if(!d.length){alert("出力する予定がありません。");return}let e="BEGIN:VCALENDAR\nVERSION:2.0\nPRODID:-//nyantagia//JP\n";d.forEach(j=>{const k=Math.random().toString(36).slice(2)+"@nyantagia",l=`[${j.member}] ${j.title}`;if(j.allDay){const m=j.startDate.replace(/\//g,""),n=(j.endDate||j.startDate).replace(/\//g,"");e+=`BEGIN:VEVENT
SUMMARY:${l}
DTSTART;VALUE=DATE:${m}
DTEND;VALUE=DATE:${n}
DESCRIPTION:${j.description}
UID:${k}
END:VEVENT
`}else{const o=H(j.startDate,j.startTime),p=H(j.endDate,j.endTime);e+=`BEGIN:VEVENT
SUMMARY:${l}
DTSTART:${o}
DTEND:${p}
DESCRIPTION:${j.description}
UID:${k}
END:VEVENT
`}});e+="END:VCALENDAR";const f=new Blob([e],{type:"text/calendar"}),g=document.createElement("a");g.href=URL.createObjectURL(f);const h=c==="all"?"all_members":c;g.download=`${h}.ics`;g.click()};
            const J=d=>{const e=b.indexOf(d),f=e>=0?e%8:0;return"member-color-"+f};
            const K=C(()=>c==="all"?a:a.filter(d=>d.member===c),[a,c]);
            const L=C(()=>{const d=new Set(K.map(e=>e.startDate)),f=Array.from(d);return f.sort((g,h)=>g.localeCompare(h)),f},[K]);
            const M=C(()=>{if(!a.length)return null;const d=Array.from(new Set(a.map(e=>e.startDate)));d.sort((e,f)=>e.localeCompare(f));return{start:d[0],end:d[d.length-1]}},[a]);
            const N=C(()=>{const d=new Set(K.filter(e=>!e.allDay&&e.startTime).map(e=>e.startTime)),f=Array.from(d);return f.sort((g,h)=>{const[i,j]=g.split(":").map(Number),[k,l]=h.split(":").map(Number);return i-k||j-l}),f},[K]);
            const O=d=>{const[e,f,g]=d.split("/").map(Number),h=new Date(e,f-1,g),i=["日","月","火","水","木","金","土"][h.getDay()];return"("+i+")"};
            return(
                <div>
                    {M&&(
                        <div className="mb-3 text-muted" style={{fontSize:"0.9rem"}}>
                            スケジュール期間：<strong>{M.start}</strong> 〜 <strong>{M.end}</strong>
                        </div>
                    )}
                    {a.length>0&&(
                        <>
                            <div className="d-flex flex-wrap gap-2 align-items-center mb-3">
                                <label className="form-label fw-bold mb-0">メンバー選択</label>
                                <select className="form-select w-auto" value={c} onChange={d=>F2(d.target.value)}>
                                    <option value="all">全員まとめて</option>
                                    {b.map(d=>(
                                        <option key={d} value={d}>{d}</option>
                                    ))}
                                </select>
                                <button className="btn btn-primary" onClick={I}>
                                    Google・Appleカレンダー用 ICS ダウンロード
                                </button>
                            </div>

                            <div className="mb-3">
                                <span className="fw-bold me-2">メンバー色分け</span>
                                {b.map(d=>(
                                    <span key={d} className={"member-legend-badge "+J(d)}>{d}</span>
                                ))}
                            </div>

                            <h5 className="fw-bold mb-2 d-none d-md-block">カレンダー風タイムテーブル</h5>
                            <div className="timetable-wrapper mb-4 d-none d-md-block">
                                <div className="timetable">
                                    <table className="table table-bordered table-sm mb-0">
                                        <thead>
                                        <tr>
                                            <th className="time-col">時間</th>
                                            {L.map(d=>(
                                                <th key={d} className="date-header">
                                                    {d}<br/>
                                                    <span className="text-muted">{O(d)}</span>
                                                </th>
                                            ))}
                                        </tr>
                                        </thead>
                                        <tbody>
                                        <tr>
                                            <th className="time-col" scope="row">終日</th>
                                            {L.map(d=>{
                                                const e=K.filter(f=>f.allDay&&f.startDate===d);
                                                return(
                                                    <td key={d}>
                                                        {e.map((f,g)=>(
                                                            <span key={g} className={"event-chip "+J(f.member)}>
                                [{f.member}] {f.title}
                              </span>
                                                        ))}
                                                    </td>
                                                );
                                            })}
                                        </tr>
                                        {N.map(d=>(
                                            <tr key={d}>
                                                <th className="time-col" scope="row">{d}</th>
                                                {L.map(e=>{
                                                    const f=K.filter(g=>!g.allDay&&g.startDate===e&&g.startTime===d);
                                                    return(
                                                        <td key={e+d}>
                                                            {f.map((g,h)=>(
                                                                <span key={h} className={"event-chip "+J(g.member)}>
                                  [{g.member}] {g.title}{g.endTime&&<>（〜{g.endTime}）</>}
                                </span>
                                                            ))}
                                                        </td>
                                                    );
                                                })}
                                            </tr>
                                        ))}
                                        </tbody>
                                    </table>
                                </div>
                            </div>

                            <h5 className="fw-bold mb-2 d-block d-md-none">スマホ用タイムテーブル</h5>
                            <div className="mb-4 d-block d-md-none">
                                {L.map(d=>{
                                    const e=K.filter(f=>f.startDate===d).slice().sort((f,g)=>{
                                        if(f.allDay&&!g.allDay)return-1;
                                        if(!f.allDay&&g.allDay)return 1;
                                        if(f.allDay&&g.allDay)return 0;
                                        const h=f.startTime||"00:00",i=g.startTime||"00:00";
                                        return h.localeCompare(i);
                                    });
                                    const f=e.filter(g=>g.allDay),g=e.filter(h=>!h.allDay);
                                    return(
                                        <div key={d} className="mobile-day-card">
                                            <div className="fw-bold mb-1">
                                                {d} <span className="text-muted">{O(d)}</span>
                                            </div>
                                            {f.length>0&&(
                                                <div className="mb-1">
                                                    <div className="text-muted" style={{fontSize:".75rem"}}>終日</div>
                                                    {f.map((h,i)=>(
                                                        <div key={i} className={"event-chip "+J(h.member)} style={{display:"inline-block",marginRight:"4px"}}>
                                                            [{h.member}] {h.title}
                                                        </div>
                                                    ))}
                                                </div>
                                            )}
                                            {g.map((h,i)=>(
                                                <div key={i} className="mobile-event-row">
                                                    <div className="mobile-event-time">
                                                        {h.startTime}{h.endTime&&<div>〜{h.endTime}</div>}
                                                    </div>
                                                    <div className="mobile-event-content">
                          <span className={"event-chip "+J(h.member)} style={{display:"inline-block"}}>
                            [{h.member}] {h.title}
                          </span>
                                                    </div>
                                                </div>
                                            ))}
                                            {e.length===0&&(
                                                <div className="text-muted" style={{fontSize:".8rem"}}>
                                                    この日の予定はありません
                                                </div>
                                            )}
                                        </div>
                                    );
                                })}
                            </div>

                            <h5 className="fw-bold mt-2">リストプレビュー</h5>
                            {K.map((d,e)=>(
                                <div className="event-card" key={e}>
                                    <b>[{d.member}] {d.title}</b><br/>
                                    {d.allDay?`${d.startDate} 終日`:`${d.startDate} ${d.startTime} 〜 ${d.endDate} ${d.endTime}`}
                                    <br/>
                                    <small className="text-muted">{d.description}</small>
                                </div>
                            ))}
                        </>
                    )}
                </div>
            );
        }

        ReactDOM.createRoot(document.getElementById("app")).render(<G />);
    })();
</script>
</body>
</html>
